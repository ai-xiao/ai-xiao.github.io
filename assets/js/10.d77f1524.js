(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{363:function(t,a,e){"use strict";e.r(a);var s=e(42),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"环境部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#环境部署"}},[t._v("#")]),t._v(" 环境部署")]),t._v(" "),e("h2",{attrs:{id:"准备工作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[t._v("#")]),t._v(" 准备工作")]),t._v(" "),e("hr"),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("JDK >= 1.8 (推荐1.8版本)")]),t._v(" "),e("li",[t._v("Mysql >= 5.5.0 (推荐5.7版本)")]),t._v(" "),e("li",[t._v("Redis >= 3.0")]),t._v(" "),e("li",[t._v("Maven >= 3.0")]),t._v(" "),e("li",[t._v("Node >= 10")]),t._v(" "),e("li",[t._v("nacos >= 1.1.0")]),t._v(" "),e("li",[t._v("sentinel >= 1.6.0")])])]),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"提示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提示"}},[t._v("#")]),t._v(" 提示")]),t._v(" "),e("p",[t._v("前端安装完node后，最好设置下淘宝的镜像源，不建议使用cnpm（可能会出现奇怪的问题）")])]),t._v(" "),e("h2",{attrs:{id:"运行系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#运行系统"}},[t._v("#")]),t._v(" 运行系统")]),t._v(" "),e("hr"),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"提示-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提示-2"}},[t._v("#")]),t._v(" 提示")]),t._v(" "),e("p",[t._v("因为本项目是前后端分离的，所以需要前后端都启动好，才能进行访问，另外也需要启动redis")])]),t._v(" "),e("h4",{attrs:{id:"后端运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#后端运行"}},[t._v("#")]),t._v(" 后端运行")]),t._v(" "),e("ol",[e("li",[t._v("导入jeethink到Eclipse，菜单 File -> Import，然后选择 Maven -> Existing Maven Projects，点击 Next> 按钮，选择工作目录，然后点击 Finish 按钮，即可成功导入Eclipse会自动加载Maven依赖包，初次加载会比较慢（根据自身网络情况而定）")]),t._v(" "),e("li",[t._v("创建数据库jeethink-cloud并导入数据脚本jeethink-cloud.sql（必须），quartz.sql（可选）")]),t._v(" "),e("li",[t._v("创建数据库jeethink-config并导入数据脚本jeethink-config.sql（必须）")]),t._v(" "),e("li",[t._v("配置nacos持久化，修改conf/application.properties文件，增加支持mysql数据源配置")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("# db mysql\nspring.datasource.platform=mysql\ndb.num=1\ndb.url.0=jdbc:mysql://localhost:3306/jeethink-config?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true\ndb.user=root\ndb.password=root\n")])])]),e("ol",{attrs:{start:"5"}},[e("li",[t._v("打开nacos，配置各个模块的数据库连接、redis")])]),t._v(" "),e("ul",[e("li",[t._v("解压nacos到本地，执行nacos\\bin\\startup.cmd")]),t._v(" "),e("li",[t._v("打开浏览器，输入：http://localhost:8848/nacos，（默认账户密码 nacos/nacos）")]),t._v(" "),e("li",[t._v("打开：配置管理->配置列表，依次对jeethink-auth-dev.yml、jeethink-system-dev.yml、jeethink-gen-dev.yml、jeethink-job-dev.yml、jeethink-gateway-dev.yml,参考以下内容进行配置")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("spring: \n  main: \n    allow-bean-definition-overriding: true\n  datasource:\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    url: jdbc:mysql://localhost:3306/jeethink-cloud?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8\n    username: root\n    password: root\n  redis:\n    host: localhost\n    port: 6379\n    password: \n")])])]),e("blockquote",[e("h4",{attrs:{id:"提示-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提示-3"}},[t._v("#")]),t._v(" 提示")]),t._v(" "),e("p",[t._v("配置修改后，记得重启nacos。 nacos官网支持三种部署模式参考(https://nacos.io/zh-cn/docs/deployment.html)")])]),t._v(" "),e("ol",{attrs:{start:"6"}},[e("li",[t._v("运行sentinel")])]),t._v(" "),e("ul",[e("li",[t._v("解压sentinel-1.7.0.zip到本地")]),t._v(" "),e("li",[t._v("修改start-sentinel.bat 内的路径为当前sentinel所在路径")]),t._v(" "),e("li",[t._v("执行start-sentinel.bat --打开浏览器，输入：http://127.0.0.1:8718/#/login，（默认账户密码 sentinel/sentinel）")])]),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"提示-4"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提示-4"}},[t._v("#")]),t._v(" 提示")]),t._v(" "),e("p",[t._v("请确保启动成功，可以正常访问，否则会导致gateway不正常。")])]),t._v(" "),e("ol",{attrs:{start:"7"}},[e("li",[t._v("启动redis")]),t._v(" "),e("li",[t._v("打开运行基础模块（启动没有先后顺序）")])]),t._v(" "),e("ul",[e("li",[t._v("JeeThinkGatewayApplication （网关模块 必须）")]),t._v(" "),e("li",[t._v("JeeThinkAuthApplication （认证模块 必须）")]),t._v(" "),e("li",[t._v("JeeThinkSystemApplication （系统模块 必须）")]),t._v(" "),e("li",[t._v("JeeThinkMonitorApplication （监控中心 可选）")]),t._v(" "),e("li",[t._v("JeeThinkGenApplication （代码生成 可选 ）")]),t._v(" "),e("li",[t._v("JeeThinkJobApplication （定时任务 可选 ）")])]),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"提示-5"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提示-5"}},[t._v("#")]),t._v(" 提示")]),t._v(" "),e("p",[t._v("Admin控制台-吉想服务状态监控（默认账户密码 jeethink/123456）")])]),t._v(" "),e("h4",{attrs:{id:"前端运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前端运行"}},[t._v("#")]),t._v(" 前端运行")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("# 进入项目目录\ncd jeethink-ui\n\n# 安装依赖\nnpm install\n\n# 强烈建议不要用直接使用 cnpm 安装，会有各种诡异的 bug，可以通过重新指定 registry 来解决 npm 安装速度慢的问题。\nnpm install --registry=https://registry.npm.taobao.org\n\n# 本地开发 启动项目\nnpm run dev\n")])])]),e("p",[t._v("打开浏览器，输入：http://localhost:80 （默认账户 admin/admin123）\n若能正确展示登录页面，并能成功登录，菜单及页面展示正常，则表明环境搭建成功")]),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"提示-6"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提示-6"}},[t._v("#")]),t._v(" 提示")]),t._v(" "),e("p",[t._v("前端安装完node后，最好设置下淘宝的镜像源，不建议使用cnpm（可能会出现奇怪的问题）")])]),t._v(" "),e("h2",{attrs:{id:"部署系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#部署系统"}},[t._v("#")]),t._v(" 部署系统")]),t._v(" "),e("hr"),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"提示-7"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提示-7"}},[t._v("#")]),t._v(" 提示")]),t._v(" "),e("p",[t._v("因为本项目是前后端分离的，所以需要前后端都部署好，才能进行访问")])]),t._v(" "),e("h4",{attrs:{id:"后端部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#后端部署"}},[t._v("#")]),t._v(" 后端部署")]),t._v(" "),e("p",[t._v("bin/package.bat 在项目的目录下执行\n然后会在项目下生成 target文件夹包含 war 或jar （多模块生成在jeethink-admin）")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("jar部署方式\n使用命令行执行：java –jar jeethink.jar 或者执行脚本：bin/run.bat")])]),t._v(" "),e("li",[e("p",[t._v("war部署方式\npom.xml packaging修改为war 放入tomcat服务器webapps")])])]),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"提示-8"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#提示-8"}},[t._v("#")]),t._v(" 提示")]),t._v(" "),e("p",[t._v("SpringBoot去除内嵌tomcat")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("\x3c!-- 排除内置tomcat --\x3e\t\t\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-web</artifactId>\n\t<exclusions>\n\t\t<exclusion>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-tomcat</artifactId>\n\t\t</exclusion>\n\t</exclusions>\n</dependency>\n")])])]),e("h4",{attrs:{id:"前端部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前端部署"}},[t._v("#")]),t._v(" 前端部署")]),t._v(" "),e("p",[t._v("当项目开发完毕，只需要运行一行命令就可以打包你的应用")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("# 打包正式环境\nnpm run build:prod\n\n# 打包预发布环境\nnpm run build:stage\n")])])]),e("p",[t._v("构建打包成功之后，会在根目录生成 dist 文件夹，里面就是构建打包好的文件，通常是 ***.js 、***.css、index.html 等静态文件。")]),t._v(" "),e("p",[t._v("通常情况下 dist 文件夹的静态文件发布到你的 nginx 或者静态服务器即可，其中的 index.html 是后台服务的入口页面。")]),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"outputdir-提示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#outputdir-提示"}},[t._v("#")]),t._v(" outputDir 提示")]),t._v(" "),e("p",[t._v("如果需要自定义构建，比如指定 dist 目录等，则需要通过 [config]的 outputDir 进行配置。")])]),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"publicpath-提示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#publicpath-提示"}},[t._v("#")]),t._v(" publicPath 提示")]),t._v(" "),e("p",[t._v("部署时改变页面js 和 css 静态引入路径 ,只需修改 vue.config.js 文件资源路径即可。")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("publicPath: './' //请根据自己路径来配置更改\n")])])]),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("export default new Router({\n  mode: 'hash', // hash模式\n})\n")])])]),e("h2",{attrs:{id:"环境变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[t._v("#")]),t._v(" 环境变量")]),t._v(" "),e("hr"),t._v(" "),e("p",[t._v("所有测试环境或者正式环境变量的配置都在 [.env.development]等 .env.xxxx文件中。")]),t._v(" "),e("p",[t._v("它们都会通过 webpack.DefinePlugin 插件注入到全局。")]),t._v(" "),e("blockquote",[e("h4",{attrs:{id:"注意"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[t._v("#")]),t._v(" 注意！！！")]),t._v(" "),e("p",[t._v("环境变量必须以VUE_APP_为开头。如:VUE_APP_API、VUE_APP_TITLE\n你在代码中可以通过如下方式获取:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("console.log(process.env.VUE_APP_xxxx)\n")])])])]),t._v(" "),e("h2",{attrs:{id:"nginx配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置"}},[t._v("#")]),t._v(" Nginx配置")]),t._v(" "),e("hr"),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("worker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n    sendfile        on;\n    keepalive_timeout  65;\n\n    server {\n        listen       80;\n        server_name  localhost;\n\n\t\tlocation / {\n            root   /home/jeethink/projects/jeethink-ui;\n\t\t\ttry_files $uri $uri/ /index.html;\n            index  index.html index.htm;\n        }\n\t\t\n\t\tlocation /prod-api/{\n\t\t\tproxy_set_header Host $http_host;\n\t\t\tproxy_set_header X-Real-IP $remote_addr;\n\t\t\tproxy_set_header REMOTE-HOST $remote_addr;\n\t\t\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\t\t\tproxy_pass http://localhost:8080/;\n\t\t}\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }\n}\n")])])]),e("h2",{attrs:{id:"tomcat配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tomcat配置"}},[t._v("#")]),t._v(" Tomcat配置")]),t._v(" "),e("hr"),t._v(" "),e("p",[t._v("修改server.xml，Host节点下添加")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<Context docBase="" path="/" reloadable="true" source=""/>\n')])])]),e("p",[t._v("dist目录的文件夹下新建WEB-INF文件夹，并在里面添加web.xml文件")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<?xml version="1.0" encoding="UTF-8"?>\n<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee" \n        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n        xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee\n        http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"\n        version="3.1" metadata-complete="true">\n     <display-name>Router for Tomcat</display-name>\n     <error-page>\n        <error-code>404</error-code>\n        <location>/index.html</location>\n    </error-page>\n</web-app>\n')])])]),e("h2",{attrs:{id:"常见问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[t._v("#")]),t._v(" 常见问题")]),t._v(" "),e("hr"),t._v(" "),e("ol",[e("li",[t._v("如果使用Mac 需要修改application.yml文件路径profile")]),t._v(" "),e("li",[t._v("如果使用Linux 提示表不存在，设置大小写敏感配置在/etc/my.cnf 添加lower_case_table_names=1，重启MYSQL服务")]),t._v(" "),e("li",[t._v("如果提示当前权限不足，无法写入文件请检查profile是否可读可写，或者无法访问此目录")])])])}),[],!1,null,null,null);a.default=n.exports}}]);